# TripleP
TripleP is a Pure P2P chat system, which can achieve the same functionalities brought by centralized server such as user login function, chat history storage and buddy list storage.

## Contribution
- A solid system design to make the user chat built upon the pure P2P architec- ture.
- Efficient algorithms to store the chat his- tory and users information distributedly.
- Stable method to automatically adapt to the users ip address change.
- An algorithm to verify a user’s identity and exchange shared keys to encrypt chat messages.
- An implementation of the designed system called TripleP.

## System Architecture
Our system adopts a 2-layer structure wildely used in other P2P system, which contains a DHT lower layer responsible for maintaining peer connections and node indexing, and an upper layer for chat application. The DHT layer of our system is an implementation of Chord. The upper layer of our system is an application layer with two applications, a chat application and a file storage application. The chat application is what users would directly interact with, which allows user to send and receive their messages. The file storage application is transparent to users, which is used for offline message, chat history and buddylist storage. In addition, all data from the upper layer are encrypted before sent to the chord layer.
Our system has the following propertities:

##### 1.Pure P2P Architecture
Most of the popular chat systems have some sort of Client-Server architecture. Some other systems are hybrids of both P2P and centrilized architecture. However, that is not desirable because a centralized service may be easily taken offline and allows a single party to gather user information. On the other hand, a pure P2P architecture can protect users’ privacy and provide better reliability. Thus, pure P2P architecture usage is the cornerstone of our project.

##### 2.Handles Dynamic IP
Some of existing pure P2P chat systems simplify the system model by assuming that IP addresses of the users are static and statically map a user to an IP address,. However, in reality, most devices connected to the internet are assigned with dynamic IPs from ISP with expiration time. If the ip address is assumed as static, the system would encounter usability issue as the IP address would change over time. Thus, our second goal is to handle this dynamic IP situation by decoupling users from their IP addresses.

Our system supports dynamic IP address by completely removing the binding between the IP address and a user’s ID. Unlike the conventional chord system, which uses the hash value of IP address as the node ID, our system uses the hash value of the user’s public key as the node ID. That public key is generated at the first time the user joins in the service.

##### 3.Statefulness and Memorability
In services like BitChat, the chat system is somewhat stateless as the system maintains no user information, such as chat history and friend list. However, we think these functions are of great importance as they are frequently used in any popular chat system. Thus, we want to build a system that is stateful and able to store user information and chat history without sacrificing other properties.

##### 4.Security
Security is always one of the important aspects that customers care about. We do care about that need and plan to build a secure chat sys- tem, specifically, by encryption and verification. Verification is required when a user wants to initialize a new chat. Encryption is used when chat messages and histories are passed and saved in other nodes in the system.

We proposed a TLS-like verification and encryption mechanism for our system. When a user uses the service for the first time, a pair of public and private key will be generated and saved. The users ID is generated by hashing the public key using SHA256. The public key and user ID is then used to verify the identity of a user.
